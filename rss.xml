<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Nahuel - Not another devops!]]></title><description><![CDATA[PersonalBlog is a GatsbyJS starter.]]></description><link>https://nahue.github.io/blog/</link><generator>RSS for Node</generator><lastBuildDate>Wed, 29 Aug 2018 19:16:24 GMT</lastBuildDate><item><title><![CDATA[Configure a Apache2 webserver]]></title><description><![CDATA[Edit /etc/ssh/sshd_config Edit /etc/apache2/sites-enabled/000-default.conf]]></description><link>https://nahue.github.io/blog//configure-a-apache2-webserver/</link><guid isPermaLink="false">https://nahue.github.io/blog//configure-a-apache2-webserver/</guid><content:encoded>&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo apt-get update
sudo apt-get install language-pack-es apache2
adduser --shell=/bin/false web
chown root:web /home/web/
chmod 755 /home/web/

cd /home/web
mkdir .ssh
cd .ssh
ssh-keygen -t rsa -f web

touch authorized_keys
cat web.pub &amp;gt; authorized_keys
cd ..
ssh-keygen -A
chmod go-w /home/web/
chown -R web:web .ssh/
chmod 755 .ssh/
chmod 755 .ssh/web
chmod 600 .ssh/authorized_keys
usermod -g www-data web
mkdir /home/web/public_html
chown -R www-data:www-data /home/web/public_html
cp /var/www/html/index.html /home/web/public_html/
chmod -R 775 /home/web/public_html&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Edit /etc/ssh/sshd_config&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;#Subsystem sftp /usr/lib/openssh/sftp-server
Subsystem sftp internal-sftp
Match User web
    ChrootDirectory %h
    ForceCommand internal-sftp
    X11Forwarding no
    AllowTCPForwarding no

/etc/init.d/ssh restart&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Edit /etc/apache2/sites-enabled/000-default.conf&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;DocumentRoot /home/web/public_html

&amp;lt;Directory /home/web/public_html/&amp;gt;
    Options FollowSymLinks
    AllowOverride All
    Require all granted
&amp;lt;/Directory&amp;gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;</content:encoded></item><item><title><![CDATA[Attach a EBS disk to a EC2 instance]]></title><link>https://nahue.github.io/blog//attach-ebs-to-ec2-instance/</link><guid isPermaLink="false">https://nahue.github.io/blog//attach-ebs-to-ec2-instance/</guid><content:encoded>&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;lsblk

sudo file -s /dev/xvdb
sudo mkfs -t ext4 /dev/xvdb

# Get device id
ls -lah /dev/disk/by-uuid/

# Add to /etc/fstab
UUID=copyuidhere       /home/web/public_html   ext4    defaults,nofail        0       2

cd /home/web
chown www-data:www-data public_html&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;</content:encoded></item><item><title><![CDATA[AWS - Schedule EC2 Shutdown and Startup]]></title><description><![CDATA[Go to the AWS dashboard, and enter the IAM module. Then you need to create the following policy under the name  . Then create a IAM Role…]]></description><link>https://nahue.github.io/blog//aws-ec2-schedule-servers/</link><guid isPermaLink="false">https://nahue.github.io/blog//aws-ec2-schedule-servers/</guid><content:encoded>&lt;p&gt;Go to the AWS dashboard, and enter the IAM module. Then you need to create the following policy under the name &lt;code class=&quot;language-text&quot;&gt;ec2_start_stop_policy&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;{
    &amp;quot;Version&amp;quot;: &amp;quot;2012-10-17&amp;quot;,
    &amp;quot;Statement&amp;quot;: [
        {
            &amp;quot;Sid&amp;quot;: &amp;quot;Stmt1444812758000&amp;quot;,
            &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
            &amp;quot;Action&amp;quot;: [
                &amp;quot;ec2:DescribeInstanceStatus&amp;quot;,
                &amp;quot;ec2:DescribeInstances&amp;quot;,
                &amp;quot;ec2:StartInstances&amp;quot;,
                &amp;quot;ec2:StopInstances&amp;quot;
            ],
            &amp;quot;Resource&amp;quot;: [
                &amp;quot;*&amp;quot;
            ]
        },
        {
            &amp;quot;Action&amp;quot;: [
                &amp;quot;logs:CreateLogGroup&amp;quot;,
                &amp;quot;logs:CreateLogStream&amp;quot;,
                &amp;quot;logs:PutLogEvents&amp;quot;
            ],
            &amp;quot;Effect&amp;quot;: &amp;quot;Allow&amp;quot;,
            &amp;quot;Resource&amp;quot;: &amp;quot;arn:aws:logs:*:*:*&amp;quot;
        }
    ]
}&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Then create a IAM Role called &lt;code class=&quot;language-text&quot;&gt;ec2_start_stop_role&lt;/code&gt;, that uses Lambda as a service, and assign the created policy.&lt;/p&gt;
&lt;p&gt;Create 2 lambda functions &lt;code class=&quot;language-text&quot;&gt;start-server&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;stop-server&lt;/code&gt;, with the following configuration:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Role&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;ec2_start_stop_role&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Memory&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;128MB&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Timeout&lt;/code&gt;: &lt;code class=&quot;language-text&quot;&gt;59s&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In the code editor, enter the following content:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;import boto3
# Enter the region your instances are in. Include only the region without specifying Availability Zone; e.g., &amp;#39;us-east-1&amp;#39;
region = &amp;#39;XX-XXXXX-X&amp;#39;
# Enter your instances here: ex. [&amp;#39;X-XXXXXXXX&amp;#39;, &amp;#39;X-XXXXXXXX&amp;#39;]
instances = [&amp;#39;X-XXXXXXXX&amp;#39;]

def lambda_handler(event, context):
    ec2 = boto3.client(&amp;#39;ec2&amp;#39;, region_name=region)
    ec2.stop_instances(InstanceIds=instances)
    print &amp;#39;stopped your instances: &amp;#39; + str(instances)&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Change &lt;code class=&quot;language-text&quot;&gt;stop_instances&lt;/code&gt; with &lt;code class=&quot;language-text&quot;&gt;start_instances&lt;/code&gt; on the &lt;code class=&quot;language-text&quot;&gt;start-server&lt;/code&gt; lambda.&lt;/p&gt;
&lt;h2&gt;Create a CloudWatch Event that triggers your Lambda function at night&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Add a trigger, select CloudWatch Events as a source.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create a new rule, and enter something like &lt;code class=&quot;language-text&quot;&gt;cron(0 1 * * ? *)&lt;/code&gt; in the expression. That means that it will run every day at 1AM.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hit Save.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Create a CloudWatch Event that triggers your Lambda function in the morning&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Add a trigger, select CloudWatch Events as a source.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Create a new rule, and enter something like &lt;code class=&quot;language-text&quot;&gt;cron(0 8 * * ? *)&lt;/code&gt; in the expression. That means that it will run every day at 8AM.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hit Save.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[How to enable swapfile]]></title><description><![CDATA[Please keep in mind that your swapfile size should be equal to your   amount.
You can check your ram size by running  . In this example we…]]></description><link>https://nahue.github.io/blog//enable-swapfile/</link><guid isPermaLink="false">https://nahue.github.io/blog//enable-swapfile/</guid><content:encoded>&lt;p&gt;Please keep in mind that your swapfile size should be equal to your &lt;code class=&quot;language-text&quot;&gt;RAM&lt;/code&gt; amount.
You can check your ram size by running &lt;code class=&quot;language-text&quot;&gt;free -m&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In this example we set a &lt;code class=&quot;language-text&quot;&gt;2GB swapfile&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo dd if=/dev/zero of=/mnt/swapfile bs=1M count=2048
sudo chown root:root /mnt/swapfile
sudo chmod 600 /mnt/swapfile
sudo mkswap /mnt/swapfile
sudo swapon /mnt/swapfile
echo &amp;quot;/mnt/swapfile swap swap defaults 0 0&amp;quot; | sudo tee -a /etc/fstab
swapon -a&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;</content:encoded></item></channel></rss>